var SocialCalc;if(!SocialCalc){SocialCalc={}}SocialCalc.FormatNumber={};SocialCalc.FormatNumber.format_definitions={};SocialCalc.FormatNumber.separatorchar=",";SocialCalc.FormatNumber.decimalchar=".";SocialCalc.FormatNumber.daynames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];SocialCalc.FormatNumber.daynames3=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"];SocialCalc.FormatNumber.monthnames3=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];SocialCalc.FormatNumber.monthnames=["January","February","March","April","May","June","July","August","September","October","November","December"];SocialCalc.FormatNumber.allowedcolors={BLACK:"#000000",BLUE:"#0000FF",CYAN:"#00FFFF",GREEN:"#00FF00",MAGENTA:"#FF00FF",RED:"#FF0000",WHITE:"#FFFFFF",YELLOW:"#FFFF00"};SocialCalc.FormatNumber.alloweddates={H:"h]",M:"m]",MM:"mm]",S:"s]",SS:"ss]"};SocialCalc.FormatNumber.commands={copy:1,color:2,integer_placeholder:3,fraction_placeholder:4,decimal:5,currency:6,general:7,separator:8,date:9,comparison:10,section:11,style:12};SocialCalc.FormatNumber.datevalues={julian_offset:2415019,seconds_in_a_day:24*60*60,seconds_in_an_hour:60*60};SocialCalc.FormatNumber.formatNumberWithFormat=function(w,L,V){var r=SocialCalc.Constants;var o=SocialCalc.FormatNumber;var K,I,O,f,A;var p,s;var G,D,X,a,Q,u,k,v;var W,t;var y="";var E;var z,J,d,l,m,h;var P;var S,B,g,T,b,M,n;var F,U,e,c,q,x,H;var N;w=w-0;N=w;if(!isFinite(N)){return"NaN"}var C=N<0?1:0;if(C){N=-N}var j=N==0?1:0;V=V||r.FormatNumber_DefaultCurrency;o.parse_format_string(o.format_definitions,L);E=o.format_definitions[L];if(!E){throw"Format not parsed error!"}z=E.sectioninfo.length-1;if(E.hascomparison){z=0;J=0;for(m=0;;m++){K=E.operators[m];I=E.operands[m];if(!K){if(J){L="General";o.parse_format_string(o.format_definitions,L);E=o.format_definitions[L];z=0}break}if(K==o.commands.section){if(!J){break}J=0;z++;continue}if(K==o.commands.comparison){S=I.indexOf(":");d=I.substring(0,S);l=I.substring(S+1)-0;if((d=="<"&&w<l)||(d=="<="&&w<=l)||(d=="="&&w==l)||(d=="<>"&&w!=l)||(d==">="&&w>=l)||(d==">"&&w>l)){break}J=1}}}else{if(z>0){if(z==1){if(C){C=0;z=1}else{z=0}}else{if(z==2){if(C){C=0;z=1}else{if(j){z=2}else{z=0}}}}}}P=E.sectioninfo[z];if(P.commas>0){for(S=0;S<P.commas;S++){N/=1000}}if(P.percent>0){for(S=0;S<P.percent;S++){N*=100}}B=1;for(S=0;S<P.fractiondigits;S++){B*=10}g=Math.floor(N*B+0.5);g=g/B;if(typeof g!="number"){return"NaN"}if(!isFinite(g)){return"NaN"}T=g+"";if(g==0&&(P.fractiondigits||P.integerdigits)){C=0}if(T.indexOf("e")>=0){return w+""}b=T.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/);if(!b){return"NaN"}M=b[1];if(!M||M=="0"){M=""}n=b[2];if(!n){n=""}if(P.hasdate){if(w<0){return"??-???-??&nbsp;??:??:??"}p=(w-Math.floor(w))*o.datevalues.seconds_in_a_day;s=w*o.datevalues.seconds_in_a_day;G=Math.floor(p/o.datevalues.seconds_in_an_hour);a=Math.floor(s/o.datevalues.seconds_in_an_hour);p=p-G*o.datevalues.seconds_in_an_hour;D=Math.floor(p/60);Q=Math.floor(s/60);X=p-D*60;B=1;for(S=0;S<P.fractiondigits;S++){B*=10}X=Math.floor(X*B+0.5);X=X/B;u=Math.floor(s*B+0.5);u=u/B;if(X>=60){X=0;D++;Q++;if(D>=60){D=0;G++;a++;if(G>=24){G=0;w++}}}n=(X-Math.floor(X))+"";n=n.substring(2);v=SocialCalc.FormatNumber.convert_date_julian_to_gregorian(Math.floor(w+o.datevalues.julian_offset));W=0;mspos=P.sectionstart;for(;;mspos++){K=E.operators[mspos];I=E.operands[mspos];if(!K){break}if(K==o.commands.section){break}if(K==o.commands.date){if((I.toLowerCase()=="am/pm"||I.toLowerCase()=="a/p")&&!k){if(G>=12){G-=12;k=I.toLowerCase()=="a/p"?r.s_FormatNumber_pm1:r.s_FormatNumber_pm}else{k=I.toLowerCase()=="a/p"?r.s_FormatNumber_am1:r.s_FormatNumber_am}if(I.indexOf(k)<0){k=k.toLowerCase()}}if(W&&(I=="m"||I=="mm")){E.operands[mspos]+="in"}if(I.charAt(0)=="h"){W=1}else{W=0}}else{if(K!=o.commands.copy){W=0}}}W=0;for(--mspos;;mspos--){K=E.operators[mspos];I=E.operands[mspos];if(!K){break}if(K==o.commands.section){break}if(K==o.commands.date){if(W&&(I=="m"||I=="mm")){E.operands[mspos]+="in"}if(I=="ss"){W=1}else{W=0}}else{if(K!=o.commands.copy){W=0}}}}F=0;U=0;e=0;c="";q="";x=r.FormatNumber_separatorchar;if(x.indexOf(" ")>=0){x=x.replace(/ /g,"&nbsp;")}H=r.FormatNumber_decimalchar;if(H.indexOf(" ")>=0){H=H.replace(/ /g,"&nbsp;")}h=P.sectionstart;while(K=E.operators[h]){I=E.operands[h++];if(K==o.commands.copy){y+=I}else{if(K==o.commands.color){c=I}else{if(K==o.commands.style){q=I}else{if(K==o.commands.integer_placeholder){if(C){y+="-";C=0}F++;if(F==1){if(M.length>P.integerdigits){for(;U<(M.length-P.integerdigits);U++){y+=M.charAt(U);if(P.thousandssep){O=M.length-U-1;if(O>2&&O%3==0){y+=x}}}}}if(M.length<P.integerdigits&&F<=P.integerdigits-M.length){if(I=="0"||I=="?"){y+=I=="0"?"0":"&nbsp;";if(P.thousandssep){O=P.integerdigits-F;if(O>2&&O%3==0){y+=x}}}}else{y+=M.charAt(U);if(P.thousandssep){O=M.length-U-1;if(O>2&&O%3==0){y+=x}}U++}}else{if(K==o.commands.fraction_placeholder){if(e>=n.length){if(I=="0"||I=="?"){y+=I=="0"?"0":"&nbsp;"}}else{y+=n.charAt(e)}e++}else{if(K==o.commands.decimal){if(C){y+="-";C=0}y+=H}else{if(K==o.commands.currency){if(C){y+="-";C=0}y+=I}else{if(K==o.commands.general){if(N!=0){var R=Math.floor(Math.LOG10E*Math.log(N));R=Math.pow(10,13-R);N=Math.floor(R*N+0.5)/R;if(!isFinite(N)){return"NaN"}}if(C){y+="-"}T=N+"";if(T.indexOf("e")>=0){y+=T;continue}b=T.match(/^\+{0,1}(\d*)(?:\.(\d*)){0,1}$/);M=b[1];if(!M||M=="0"){M=""}n=b[2];if(!n){n=""}U=0;e=0;if(M.length){for(;U<M.length;U++){y+=M.charAt(U);if(P.thousandssep){O=M.length-U-1;if(O>2&&O%3==0){y+=x}}}}else{y+="0"}if(n.length){y+=H;for(;e<n.length;e++){y+=n.charAt(e)}}}else{if(K==o.commands.date){A=I.toLowerCase();if(A=="y"||A=="yy"){y+=(v.year+"").substring(2)}else{if(A=="yyyy"){y+=v.year+""}else{if(A=="d"){y+=v.day+""}else{if(A=="dd"){f=1000+v.day;y+=(f+"").substr(2)}else{if(A=="ddd"){f=Math.floor(w+6)%7;y+=r.s_FormatNumber_daynames3[f]}else{if(A=="dddd"){f=Math.floor(w+6)%7;y+=r.s_FormatNumber_daynames[f]}else{if(A=="m"){y+=v.month+""}else{if(A=="mm"){f=1000+v.month;y+=(f+"").substr(2)}else{if(A=="mmm"){y+=r.s_FormatNumber_monthnames3[v.month-1]}else{if(A=="mmmm"){y+=r.s_FormatNumber_monthnames[v.month-1]}else{if(A=="mmmmm"){y+=r.s_FormatNumber_monthnames[v.month-1].charAt(0)}else{if(A=="h"){y+=G+""}else{if(A=="h]"){y+=a+""}else{if(A=="mmin"){f=(1000+D)+"";y+=f.substr(2)}else{if(A=="mm]"){if(Q<100){f=(1000+Q)+"";y+=f.substr(2)}else{y+=Q+""}}else{if(A=="min"){y+=D+""}else{if(A=="m]"){y+=Q+""}else{if(A=="hh"){f=(1000+G)+"";y+=f.substr(2)}else{if(A=="s"){f=Math.floor(X);y+=f+""}else{if(A=="ss"){f=(1000+Math.floor(X))+"";y+=f.substr(2)}else{if(A=="am/pm"||A=="a/p"){y+=k}else{if(A=="ss]"){if(u<100){f=(1000+Math.floor(u))+"";y+=f.substr(2)}else{f=Math.floor(u);y+=f+""}}}}}}}}}}}}}}}}}}}}}}}}else{if(K==o.commands.section){break}else{if(K==o.commands.comparison){continue}else{y+="!! Parse error !!"}}}}}}}}}}}}if(c){y='<span style="color:'+c+';">'+y+"</span>"}if(q){y='<span style="'+q+';">'+y+"</span>"}return y};SocialCalc.FormatNumber.parse_format_string=function(v,m){var e=SocialCalc.FormatNumber;var d,g,w;var p=1;var i;var l;var a;var k;var c,f;var s,h,q;var t,o;var b,r;var n;var u;var j;if(v[m]){return}d={operators:[],operands:[],sectioninfo:[{}]};v[m]=d;g=0;sectioninfo=d.sectioninfo[g];sectioninfo.sectionstart=0;sectioninfo.integerdigits=0;sectioninfo.fractiondigits=0;sectioninfo.commas=0;sectioninfo.percent=0;for(u=0;u<m.length;u++){j=m.charAt(u);if(c){if(j=='"'){c=0;d.operators.push(e.commands.copy);d.operands.push(f);continue}f+=j;continue}if(s){if(j=="]"){s=0;q=SocialCalc.FormatNumber.parse_format_bracket(h);if(q.operator==e.commands.separator){sectioninfo.thousandssep=1;continue}if(q.operator==e.commands.date){sectioninfo.hasdate=1}if(q.operator==e.commands.comparison){d.hascomparison=1}d.operators.push(q.operator);d.operands.push(q.operand);continue}h+=j;continue}if(l){d.operators.push(e.commands.copy);d.operands.push(j);l=false;continue}if(a){d.operators.push(e.commands.copy);d.operands.push(j+j+j+j+j);a=false;continue}if(k){d.operators.push(e.commands.copy);d.operands.push("&nbsp;");k=false;continue}if(t){if("general".charAt(t)==j.toLowerCase()){t++;if(t==7){d.operators.push(e.commands.general);d.operands.push(j);t=0}continue}t=0}if(n){if(n.charAt(0)==j){n+=j;continue}d.operators.push(e.commands.date);d.operands.push(n);sectioninfo.hasdate=1;n=""}if(b){b+=j;r=b.toLowerCase();if(r!="am/pm".substring(0,r.length)&&r!="a/p".substring(0,r.length)){ampstr=""}else{if(r=="am/pm"||r=="a/p"){d.operators.push(e.commands.date);d.operands.push(b);b=""}}continue}if(j=="#"||j=="0"||j=="?"){if(p){sectioninfo.integerdigits++;if(sectioninfo.commas){sectioninfo.thousandssep=1;sectioninfo.commas=0}i=1;d.operators.push(e.commands.integer_placeholder);d.operands.push(j)}else{sectioninfo.fractiondigits++;d.operators.push(e.commands.fraction_placeholder);d.operands.push(j)}}else{if(j=="."){i=0;d.operators.push(e.commands.decimal);d.operands.push(j);p=0}else{if(j=="$"){i=0;d.operators.push(e.commands.currency);d.operands.push(j)}else{if(j==","){if(i){sectioninfo.commas++}else{d.operators.push(e.commands.copy);d.operands.push(j)}}else{if(j=="%"){i=0;sectioninfo.percent++;d.operators.push(e.commands.copy);d.operands.push(j)}else{if(j=='"'){i=0;c=1;f=""}else{if(j=="["){i=0;s=1;h=""}else{if(j=="\\"){l=1;i=0}else{if(j=="*"){a=1;i=0}else{if(j=="_"){k=1;i=0}else{if(j==";"){g++;d.sectioninfo[g]={};sectioninfo=d.sectioninfo[g];sectioninfo.sectionstart=1+d.operators.length;sectioninfo.integerdigits=0;sectioninfo.fractiondigits=0;sectioninfo.commas=0;sectioninfo.percent=0;p=1;i=0;d.operators.push(e.commands.section);d.operands.push(j)}else{if(j.toLowerCase()=="g"){t=1;i=0}else{if(j.toLowerCase()=="a"){b=j;i=0}else{if("dmyhHs".indexOf(j)>=0){n=j}else{i=0;d.operators.push(e.commands.copy);d.operands.push(j)}}}}}}}}}}}}}}}if(n){d.operators.push(e.commands.date);d.operands.push(n);sectioninfo.hasdate=1}return};SocialCalc.FormatNumber.parse_format_bracket=function(d){var c=SocialCalc.FormatNumber;var b=SocialCalc.Constants;var a={};var e;if(d.charAt(0)=="$"){a.operator=c.commands.currency;e=d.match(/^\$(.+?)(\-.+?){0,1}$/);if(e){a.operand=e[1]||b.FormatNumber_defaultCurrency||"$"}else{a.operand=d.substring(1)||b.FormatNumber_defaultCurrency||"$"}}else{if(d=="?$"){a.operator=c.commands.currency;a.operand="[?$]"}else{if(c.allowedcolors[d.toUpperCase()]){a.operator=c.commands.color;a.operand=c.allowedcolors[d.toUpperCase()]}else{if(e=d.match(/^style=([^"]*)$/)){a.operator=c.commands.style;a.operand=e[1]}else{if(d==","){a.operator=c.commands.separator;a.operand=d}else{if(c.alloweddates[d.toUpperCase()]){a.operator=c.commands.date;a.operand=c.alloweddates[d.toUpperCase()]}else{if(e=d.match(/^[<>=]/)){e=d.match(/^([<>=]+)(.+)$/);a.operator=c.commands.comparison;a.operand=e[1]+":"+e[2]}else{a.operator=c.commands.copy;a.operand="["+d+"]"}}}}}}}return a};SocialCalc.FormatNumber.convert_date_gregorian_to_julian=function(b,d,a){var c;c=a-32075+SocialCalc.intFunc(1461*(b+4800+SocialCalc.intFunc((d-14)/12))/4);c+=SocialCalc.intFunc(367*(d-2-SocialCalc.intFunc((d-14)/12)*12)/12);c=c-SocialCalc.intFunc(3*SocialCalc.intFunc((b+4900+SocialCalc.intFunc((d-14)/12))/100)/4);return c};SocialCalc.FormatNumber.convert_date_julian_to_gregorian=function(e){var a,f,d,c,b;a=e+68569;f=Math.floor(4*a/146097);a=a-Math.floor((146097*f+3)/4);d=Math.floor(4000*(a+1)/1461001);a=a-Math.floor(1461*d/4)+31;c=Math.floor(80*a/2447);b=a-Math.floor(2447*c/80);a=Math.floor(c/11);c=c+2-12*a;d=100*(f-49)+d+a;return{year:d,month:c,day:b}};SocialCalc.intFunc=function(a){if(a<0){return -Math.floor(-a)}else{return Math.floor(a)}};